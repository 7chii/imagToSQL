<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>teste SQL 4 learning</h1>
    <h3 id="val"></h3>
    <img src="" alt="" id="imag">
    <form>
        <label for="nome">nome</label>
        <input type="text" id="nome">
        <label for="custo">custo</label>
        <input type="text" id="custo">
        <label for="valor">valor</label>
        <input type="text" id="valor">

        <label for="splash">splash</label>
        <input type="file" accept=".jpg" id="splash">

        <label for="id">id</label>
        <input type="text" id="id">
        <button type="submit" id="butsub">Mandar champ</button>
        <button type="submit" id="butup">Mandar skin</button>
        <hr>
        <button type="submit" id="butnome">Pesquisar img em champ</button>
        <button type="submit" id="butnomes">Pesquisar img em skins</button>
        <hr>
    </form>
<script>
    const fileinput = document.getElementById("splash");
                fileinput.addEventListener("change", e =>{
                    const file = fileinput.files[0];
                    const reader = new FileReader();

                    reader.addEventListener("load", ()=>{
                        console.log(reader.result);
                        let str = reader.result;
                        document.getElementById("imag").src = str;
                    });
                    reader.readAsDataURL(file);
                });
                function crimg(data){
            var img = document.getElementById("imag");
            var stringp = data.split('-');
            var val = document.getElementById("val");
            img.src = "data:image/jpg;base64, "+stringp[0];
            val.innerHTML = `VAL:${stringp[1]}|Custo:${stringp[2]}|Valor:${stringp[3]}`;
                };
                document.querySelector('#butnomes').addEventListener('click', (e)=>{
        e.preventDefault();
        const str = document.getElementById("imag").src;
                const nome = document
                    .querySelector('#nome').value;
 
                const valor = document
                    .querySelector('#valor').value;

                const custo = document.querySelector('#custo').value;

                const id = document.querySelector('#id').value;

                //const img = document.querySelector('#splash').value;
                fetch('/imgs', {
                    method: 'POST',
                    headers: {
                        Authorization: 'Bearer abcdxyz',
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        nome,
                        custo,
                        valor,
                        id,
                        str
                    }),
                })
                    .then((res) => {
                        return res.json();
                    })
                    .then((data) => console.log(crimg(data)));
            });
    document.querySelector('#butnome').addEventListener('click', (e)=>{
        e.preventDefault();
        const str = document.getElementById("imag").src;
                const nome = document
                    .querySelector('#nome').value;
 
                const valor = document
                    .querySelector('#valor').value;

                const custo = document.querySelector('#custo').value;

                const id = document.querySelector('#id').value;

                //const img = document.querySelector('#splash').value;
                fetch('/img', {
                    method: 'POST',
                    headers: {
                        Authorization: 'Bearer abcdxyz',
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        nome,
                        custo,
                        valor,
                        id,
                        str
                    }),
                })
                    .then((res) => {
                        return res.json();
                    })
                    .then((data) => console.log(crimg(data)));
            });
            document.querySelector('#butup')
            .addEventListener('click', (e) => {
                e.preventDefault();
                const str = document.getElementById("imag").src;
                const nome = document
                    .querySelector('#nome').value;
 
                const valor = document
                    .querySelector('#valor').value;

                const custo = document.querySelector('#custo').value;

                const id = document.querySelector('#id').value;
                fetch('/spost', {
                    method: 'POST',
                    headers: {
                        Authorization: 'Bearer abcdxyz',
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        nome,
                        custo,
                        valor,
                        id,
                        str
                    }),
                })
                    .then((res) => {
                        return res.json();
                    })
                    .then((data) => console.log(data));
            });
        
    document.querySelector('#butsub')
            .addEventListener('click', (e) => {
                e.preventDefault();
                const str = document.getElementById("imag").src;
                const nome = document
                    .querySelector('#nome').value;
 
                const valor = document
                    .querySelector('#valor').value;

                const custo = document.querySelector('#custo').value;

                const id = document.querySelector('#id').value;

                //const img = document.querySelector('#splash').value;
                fetch('/fpost', {
                    method: 'POST',
                    headers: {
                        Authorization: 'Bearer abcdxyz',
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        nome,
                        custo,
                        valor,
                        id,
                        str
                    }),
                })
                    .then((res) => {
                        return res.json();
                    })
                    .then((data) => console.log(data));
            });

</script>
</body>
</html>